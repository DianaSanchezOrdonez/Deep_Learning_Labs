Using device: cuda
Dataset sizes - Train: 3334, Eval: 3333, Test: 3333
Fine-tuning completo - todas las capas se entrenarán
Parámetros totales: 23,712,932
Parámetros entrenables: 23,712,932
Parámetros congelados: 0
Optimización con learning rates diferenciados
Starting training...

Epoch [1/100]
Train Loss: 4.6289 Acc: 3.42% | Eval Loss: 4.4323 Acc: 6.24% Prec: 0.04 Recall: 0.06 F1: 0.02
✅ New best model saved with eval accuracy: 6.24%

Epoch [2/100]
Train Loss: 3.6748 Acc: 11.25% | Eval Loss: 3.4491 Acc: 15.84% Prec: 0.17 Recall: 0.16 F1: 0.12
✅ New best model saved with eval accuracy: 15.84%

Epoch [3/100]
Train Loss: 3.1539 Acc: 20.01% | Eval Loss: 2.7644 Acc: 25.20% Prec: 0.31 Recall: 0.25 F1: 0.21
✅ New best model saved with eval accuracy: 25.20%

Epoch [4/100]
Train Loss: 2.8122 Acc: 24.63% | Eval Loss: 2.6504 Acc: 27.42% Prec: 0.28 Recall: 0.27 F1: 0.22
✅ New best model saved with eval accuracy: 27.42%

Epoch [5/100]
Train Loss: 2.5690 Acc: 31.16% | Eval Loss: 2.6131 Acc: 29.97% Prec: 0.36 Recall: 0.30 F1: 0.27
✅ New best model saved with eval accuracy: 29.97%

Epoch [6/100]
Train Loss: 2.3474 Acc: 34.31% | Eval Loss: 2.4312 Acc: 35.88% Prec: 0.45 Recall: 0.36 F1: 0.34
✅ New best model saved with eval accuracy: 35.88%

Epoch [7/100]
Train Loss: 2.2012 Acc: 36.23% | Eval Loss: 2.2011 Acc: 40.32% Prec: 0.50 Recall: 0.40 F1: 0.38
✅ New best model saved with eval accuracy: 40.32%

Epoch [8/100]
Train Loss: 2.1821 Acc: 38.18% | Eval Loss: 2.0855 Acc: 41.73% Prec: 0.50 Recall: 0.42 F1: 0.39
✅ New best model saved with eval accuracy: 41.73%

Epoch [9/100]
Train Loss: 1.9946 Acc: 42.32% | Eval Loss: 2.0411 Acc: 42.66% Prec: 0.49 Recall: 0.43 F1: 0.40
✅ New best model saved with eval accuracy: 42.66%

Epoch [10/100]
Train Loss: 1.8686 Acc: 44.57% | Eval Loss: 1.8239 Acc: 48.54% Prec: 0.58 Recall: 0.49 F1: 0.46
✅ New best model saved with eval accuracy: 48.54%

Epoch [11/100]
Train Loss: 1.7548 Acc: 49.22% | Eval Loss: 1.8407 Acc: 48.24% Prec: 0.55 Recall: 0.48 F1: 0.47

Epoch [12/100]
Train Loss: 1.7216 Acc: 50.09% | Eval Loss: 1.8251 Acc: 49.20% Prec: 0.58 Recall: 0.49 F1: 0.48
✅ New best model saved with eval accuracy: 49.20%

Epoch [13/100]
Train Loss: 1.6409 Acc: 51.53% | Eval Loss: 1.7088 Acc: 51.88% Prec: 0.57 Recall: 0.52 F1: 0.50
✅ New best model saved with eval accuracy: 51.88%

Epoch [14/100]
Train Loss: 1.5679 Acc: 52.55% | Eval Loss: 2.2142 Acc: 46.14% Prec: 0.53 Recall: 0.46 F1: 0.45

Epoch [15/100]
Train Loss: 1.5333 Acc: 53.99% | Eval Loss: 1.9069 Acc: 51.34% Prec: 0.55 Recall: 0.51 F1: 0.50

Epoch [16/100]
Train Loss: 1.4817 Acc: 55.04% | Eval Loss: 1.7347 Acc: 53.92% Prec: 0.58 Recall: 0.54 F1: 0.52
✅ New best model saved with eval accuracy: 53.92%

Epoch [17/100]
Train Loss: 1.3736 Acc: 57.74% | Eval Loss: 1.8240 Acc: 53.23% Prec: 0.58 Recall: 0.53 F1: 0.51

Epoch [18/100]
Train Loss: 1.3214 Acc: 59.69% | Eval Loss: 1.8990 Acc: 51.79% Prec: 0.59 Recall: 0.52 F1: 0.50

Epoch [19/100]
Train Loss: 1.2528 Acc: 60.98% | Eval Loss: 1.9476 Acc: 52.03% Prec: 0.60 Recall: 0.52 F1: 0.52

Epoch [20/100]
Train Loss: 1.2354 Acc: 61.88% | Eval Loss: 1.9325 Acc: 52.27% Prec: 0.60 Recall: 0.52 F1: 0.51

Epoch [21/100]
Train Loss: 1.2175 Acc: 63.62% | Eval Loss: 1.7084 Acc: 56.44% Prec: 0.61 Recall: 0.56 F1: 0.55
✅ New best model saved with eval accuracy: 56.44%

Epoch [22/100]
Train Loss: 1.1627 Acc: 63.50% | Eval Loss: 1.7470 Acc: 56.53% Prec: 0.64 Recall: 0.57 F1: 0.56
✅ New best model saved with eval accuracy: 56.53%

Epoch [23/100]
Train Loss: 1.1838 Acc: 63.20% | Eval Loss: 1.7340 Acc: 58.21% Prec: 0.62 Recall: 0.58 F1: 0.57
✅ New best model saved with eval accuracy: 58.21%

Epoch [24/100]
Train Loss: 1.0998 Acc: 65.93% | Eval Loss: 1.6224 Acc: 58.57% Prec: 0.61 Recall: 0.59 F1: 0.57
✅ New best model saved with eval accuracy: 58.57%

Epoch [25/100]
Train Loss: 1.0802 Acc: 66.47% | Eval Loss: 1.7074 Acc: 57.52% Prec: 0.63 Recall: 0.58 F1: 0.57

Epoch [26/100]
Train Loss: 1.0251 Acc: 68.42% | Eval Loss: 1.9192 Acc: 53.23% Prec: 0.60 Recall: 0.53 F1: 0.52

Epoch [27/100]
Train Loss: 0.9564 Acc: 70.49% | Eval Loss: 1.7459 Acc: 57.82% Prec: 0.63 Recall: 0.58 F1: 0.57

Epoch [28/100]
Train Loss: 1.0521 Acc: 68.09% | Eval Loss: 1.8677 Acc: 57.79% Prec: 0.63 Recall: 0.58 F1: 0.57

Epoch [29/100]
Train Loss: 0.9705 Acc: 69.65% | Eval Loss: 1.8656 Acc: 57.07% Prec: 0.62 Recall: 0.57 F1: 0.55

Epoch [30/100]
Train Loss: 0.9869 Acc: 69.68% | Eval Loss: 1.9240 Acc: 55.60% Prec: 0.61 Recall: 0.56 F1: 0.55

Epoch [31/100]
Train Loss: 1.0025 Acc: 69.02% | Eval Loss: 2.1601 Acc: 53.20% Prec: 0.63 Recall: 0.53 F1: 0.52

Epoch [32/100]
Train Loss: 0.9145 Acc: 71.60% | Eval Loss: 1.8190 Acc: 57.76% Prec: 0.64 Recall: 0.58 F1: 0.57

Epoch [33/100]
Train Loss: 0.8873 Acc: 72.14% | Eval Loss: 1.8162 Acc: 60.04% Prec: 0.64 Recall: 0.60 F1: 0.59
✅ New best model saved with eval accuracy: 60.04%

Epoch [34/100]
Train Loss: 0.8534 Acc: 73.79% | Eval Loss: 1.8006 Acc: 59.50% Prec: 0.66 Recall: 0.60 F1: 0.59

Epoch [35/100]
Train Loss: 0.8337 Acc: 74.27% | Eval Loss: 1.7808 Acc: 59.20% Prec: 0.63 Recall: 0.59 F1: 0.59

Epoch [36/100]
Train Loss: 0.8093 Acc: 74.60% | Eval Loss: 1.7592 Acc: 59.74% Prec: 0.64 Recall: 0.60 F1: 0.59

Epoch [37/100]
Train Loss: 0.7664 Acc: 76.30% | Eval Loss: 1.7957 Acc: 60.04% Prec: 0.65 Recall: 0.60 F1: 0.59

Epoch [38/100]
Train Loss: 0.7570 Acc: 76.21% | Eval Loss: 1.8163 Acc: 60.43% Prec: 0.64 Recall: 0.60 F1: 0.60
✅ New best model saved with eval accuracy: 60.43%

Epoch [39/100]
Train Loss: 0.7589 Acc: 76.54% | Eval Loss: 1.9091 Acc: 59.29% Prec: 0.64 Recall: 0.59 F1: 0.59

Epoch [40/100]
Train Loss: 0.7065 Acc: 77.83% | Eval Loss: 1.9066 Acc: 59.11% Prec: 0.64 Recall: 0.59 F1: 0.58

Epoch [41/100]
Train Loss: 0.7559 Acc: 76.75% | Eval Loss: 2.0304 Acc: 59.50% Prec: 0.67 Recall: 0.60 F1: 0.59

Epoch [42/100]
Train Loss: 0.7389 Acc: 77.47% | Eval Loss: 1.7832 Acc: 62.20% Prec: 0.65 Recall: 0.62 F1: 0.61
✅ New best model saved with eval accuracy: 62.20%

Epoch [43/100]
Train Loss: 0.6534 Acc: 79.99% | Eval Loss: 1.9021 Acc: 59.53% Prec: 0.64 Recall: 0.60 F1: 0.60

Epoch [44/100]
Train Loss: 0.7363 Acc: 77.23% | Eval Loss: 1.8785 Acc: 61.66% Prec: 0.68 Recall: 0.62 F1: 0.62

Epoch [45/100]
Train Loss: 0.6650 Acc: 79.42% | Eval Loss: 1.9098 Acc: 61.72% Prec: 0.65 Recall: 0.62 F1: 0.61

Epoch [46/100]
Train Loss: 0.6768 Acc: 79.60% | Eval Loss: 1.7855 Acc: 61.42% Prec: 0.66 Recall: 0.61 F1: 0.61

Epoch [47/100]
Train Loss: 0.6310 Acc: 80.02% | Eval Loss: 1.9451 Acc: 60.37% Prec: 0.65 Recall: 0.60 F1: 0.60

Epoch [48/100]
Train Loss: 0.6044 Acc: 81.10% | Eval Loss: 1.9544 Acc: 60.52% Prec: 0.65 Recall: 0.61 F1: 0.60

Epoch [49/100]
Train Loss: 0.6318 Acc: 80.08% | Eval Loss: 2.2023 Acc: 58.60% Prec: 0.66 Recall: 0.59 F1: 0.58

Epoch [50/100]
Train Loss: 0.6226 Acc: 80.20% | Eval Loss: 2.0915 Acc: 58.21% Prec: 0.65 Recall: 0.58 F1: 0.58

Epoch [51/100]
Train Loss: 0.6754 Acc: 79.69% | Eval Loss: 2.1078 Acc: 58.24% Prec: 0.65 Recall: 0.58 F1: 0.58

Epoch [52/100]
Train Loss: 0.5618 Acc: 82.36% | Eval Loss: 1.9291 Acc: 60.97% Prec: 0.66 Recall: 0.61 F1: 0.60

Epoch [53/100]
Train Loss: 0.6185 Acc: 80.80% | Eval Loss: 2.0929 Acc: 61.06% Prec: 0.67 Recall: 0.61 F1: 0.62

Epoch [54/100]
Train Loss: 0.5963 Acc: 80.92% | Eval Loss: 1.8915 Acc: 62.83% Prec: 0.66 Recall: 0.63 F1: 0.62
✅ New best model saved with eval accuracy: 62.83%

Epoch [55/100]
Train Loss: 0.5845 Acc: 82.60% | Eval Loss: 1.9758 Acc: 61.63% Prec: 0.66 Recall: 0.62 F1: 0.61

Epoch [56/100]
Train Loss: 0.5610 Acc: 81.97% | Eval Loss: 2.1156 Acc: 61.96% Prec: 0.68 Recall: 0.62 F1: 0.62

Epoch [57/100]
Train Loss: 0.6072 Acc: 81.61% | Eval Loss: 2.0962 Acc: 60.07% Prec: 0.64 Recall: 0.60 F1: 0.59

Epoch [58/100]
Train Loss: 0.5191 Acc: 83.41% | Eval Loss: 1.9579 Acc: 62.47% Prec: 0.67 Recall: 0.63 F1: 0.63

Epoch [59/100]
Train Loss: 0.5243 Acc: 83.32% | Eval Loss: 2.1193 Acc: 60.31% Prec: 0.66 Recall: 0.60 F1: 0.60

Epoch [60/100]
Train Loss: 0.5035 Acc: 84.04% | Eval Loss: 2.0406 Acc: 61.78% Prec: 0.66 Recall: 0.62 F1: 0.61

Epoch [61/100]
Train Loss: 0.6488 Acc: 80.71% | Eval Loss: 2.1481 Acc: 60.22% Prec: 0.65 Recall: 0.60 F1: 0.60

Epoch [62/100]
Train Loss: 0.5030 Acc: 84.22% | Eval Loss: 1.9908 Acc: 63.19% Prec: 0.68 Recall: 0.63 F1: 0.63
✅ New best model saved with eval accuracy: 63.19%

Epoch [63/100]
Train Loss: 0.4713 Acc: 85.27% | Eval Loss: 2.0188 Acc: 63.40% Prec: 0.67 Recall: 0.63 F1: 0.63
✅ New best model saved with eval accuracy: 63.40%

Epoch [64/100]
Train Loss: 0.5442 Acc: 83.26% | Eval Loss: 2.2539 Acc: 61.12% Prec: 0.66 Recall: 0.61 F1: 0.60

Epoch [65/100]
Train Loss: 0.5296 Acc: 84.16% | Eval Loss: 2.2607 Acc: 59.08% Prec: 0.64 Recall: 0.59 F1: 0.59

Epoch [66/100]
Train Loss: 0.5042 Acc: 85.33% | Eval Loss: 2.0720 Acc: 62.05% Prec: 0.65 Recall: 0.62 F1: 0.61

Epoch [67/100]
Train Loss: 0.5007 Acc: 84.43% | Eval Loss: 2.0235 Acc: 61.99% Prec: 0.66 Recall: 0.62 F1: 0.62

Epoch [68/100]
Train Loss: 0.5101 Acc: 84.19% | Eval Loss: 2.1008 Acc: 60.25% Prec: 0.65 Recall: 0.60 F1: 0.60

Epoch [69/100]
Train Loss: 0.4713 Acc: 85.69% | Eval Loss: 2.2083 Acc: 60.97% Prec: 0.66 Recall: 0.61 F1: 0.61

Epoch [70/100]
Train Loss: 0.4634 Acc: 85.36% | Eval Loss: 2.1546 Acc: 62.41% Prec: 0.66 Recall: 0.62 F1: 0.62

Epoch [71/100]
Train Loss: 0.4521 Acc: 85.54% | Eval Loss: 2.2483 Acc: 60.91% Prec: 0.65 Recall: 0.61 F1: 0.61

Epoch [72/100]
Train Loss: 0.5367 Acc: 83.83% | Eval Loss: 2.2313 Acc: 60.67% Prec: 0.67 Recall: 0.61 F1: 0.60

Epoch [73/100]
Train Loss: 0.4575 Acc: 85.57% | Eval Loss: 2.1446 Acc: 62.74% Prec: 0.67 Recall: 0.63 F1: 0.62

Epoch [74/100]
Train Loss: 0.5099 Acc: 84.16% | Eval Loss: 2.1778 Acc: 61.99% Prec: 0.66 Recall: 0.62 F1: 0.62

Epoch [75/100]
Train Loss: 0.5118 Acc: 85.03% | Eval Loss: 2.5670 Acc: 57.46% Prec: 0.63 Recall: 0.57 F1: 0.57

Epoch [76/100]
Train Loss: 0.6158 Acc: 82.48% | Eval Loss: 2.3418 Acc: 59.41% Prec: 0.66 Recall: 0.59 F1: 0.59

Epoch [77/100]
Train Loss: 0.5090 Acc: 84.19% | Eval Loss: 2.1054 Acc: 63.10% Prec: 0.68 Recall: 0.63 F1: 0.63

Epoch [78/100]
Train Loss: 0.5420 Acc: 83.89% | Eval Loss: 2.1365 Acc: 62.92% Prec: 0.67 Recall: 0.63 F1: 0.62

⏹️ Early stopping activado en epoch 78

Evaluating on test set...
Final Test Results - Loss: 2.1227 | Acc: 62.89% | Prec: 0.67 | Recall: 0.63 | F1: 0.62

Training completed!
Best model saved as 'v1_best_model_resnet50_flush.pth'
Training history saved as 'v1_training_history.json'
📊 Gráfico guardado como 'v1_training_history_resnet50.png'

Computing confusion matrix on test set...
