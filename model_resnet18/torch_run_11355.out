Using device: cuda
Dataset sizes - Train: 7000, Eval: 1000, Test: 2000
Fine-tuning completo - todas las capas se entrenar√°n
Par√°metros totales: 11,227,812
Par√°metros entrenables: 11,227,812
Par√°metros congelados: 0
Optimizaci√≥n con learning rates diferenciados
Starting training...

Epoch [1/100]
Train Loss: 4.3744 Acc: 5.17% | Eval Loss: 3.6998 Acc: 13.10% Prec: 0.14 Recall: 0.13 F1: 0.10
‚úÖ New best model saved with eval accuracy: 13.10%

Epoch [2/100]
Train Loss: 3.3972 Acc: 16.53% | Eval Loss: 3.0456 Acc: 21.50% Prec: 0.20 Recall: 0.21 F1: 0.17
‚úÖ New best model saved with eval accuracy: 21.50%

Epoch [3/100]
Train Loss: 2.9203 Acc: 24.20% | Eval Loss: 2.3897 Acc: 32.80% Prec: 0.34 Recall: 0.33 F1: 0.28
‚úÖ New best model saved with eval accuracy: 32.80%

Epoch [4/100]
Train Loss: 2.6131 Acc: 30.69% | Eval Loss: 2.1137 Acc: 39.40% Prec: 0.46 Recall: 0.39 F1: 0.36
‚úÖ New best model saved with eval accuracy: 39.40%

Epoch [5/100]
Train Loss: 2.3757 Acc: 34.77% | Eval Loss: 2.0345 Acc: 41.90% Prec: 0.47 Recall: 0.42 F1: 0.39
‚úÖ New best model saved with eval accuracy: 41.90%

Epoch [6/100]
Train Loss: 2.2015 Acc: 39.36% | Eval Loss: 1.8628 Acc: 44.70% Prec: 0.47 Recall: 0.45 F1: 0.42
‚úÖ New best model saved with eval accuracy: 44.70%

Epoch [7/100]
Train Loss: 2.0767 Acc: 42.21% | Eval Loss: 1.7852 Acc: 47.40% Prec: 0.54 Recall: 0.47 F1: 0.45
‚úÖ New best model saved with eval accuracy: 47.40%

Epoch [8/100]
Train Loss: 1.9427 Acc: 45.14% | Eval Loss: 1.6249 Acc: 52.60% Prec: 0.58 Recall: 0.53 F1: 0.51
‚úÖ New best model saved with eval accuracy: 52.60%

Epoch [9/100]
Train Loss: 1.8783 Acc: 46.50% | Eval Loss: 1.7096 Acc: 49.80% Prec: 0.58 Recall: 0.50 F1: 0.48

Epoch [10/100]
Train Loss: 1.7963 Acc: 47.63% | Eval Loss: 1.5318 Acc: 53.80% Prec: 0.58 Recall: 0.54 F1: 0.52
‚úÖ New best model saved with eval accuracy: 53.80%

Epoch [11/100]
Train Loss: 1.7335 Acc: 49.84% | Eval Loss: 1.7053 Acc: 50.40% Prec: 0.57 Recall: 0.50 F1: 0.48

Epoch [12/100]
Train Loss: 1.6508 Acc: 51.99% | Eval Loss: 1.5624 Acc: 54.70% Prec: 0.60 Recall: 0.55 F1: 0.53
‚úÖ New best model saved with eval accuracy: 54.70%

Epoch [13/100]
Train Loss: 1.5668 Acc: 53.61% | Eval Loss: 1.4292 Acc: 60.60% Prec: 0.63 Recall: 0.61 F1: 0.58
‚úÖ New best model saved with eval accuracy: 60.60%

Epoch [14/100]
Train Loss: 1.5083 Acc: 55.27% | Eval Loss: 1.5183 Acc: 56.40% Prec: 0.63 Recall: 0.56 F1: 0.55

Epoch [15/100]
Train Loss: 1.4829 Acc: 55.67% | Eval Loss: 1.2993 Acc: 61.10% Prec: 0.65 Recall: 0.61 F1: 0.59
‚úÖ New best model saved with eval accuracy: 61.10%

Epoch [16/100]
Train Loss: 1.4402 Acc: 57.11% | Eval Loss: 1.3901 Acc: 59.70% Prec: 0.64 Recall: 0.60 F1: 0.59

Epoch [17/100]
Train Loss: 1.4112 Acc: 57.60% | Eval Loss: 1.3236 Acc: 60.50% Prec: 0.66 Recall: 0.61 F1: 0.59

Epoch [18/100]
Train Loss: 1.3194 Acc: 59.90% | Eval Loss: 1.4099 Acc: 59.30% Prec: 0.65 Recall: 0.59 F1: 0.58

Epoch [19/100]
Train Loss: 1.3352 Acc: 59.43% | Eval Loss: 1.2896 Acc: 63.80% Prec: 0.67 Recall: 0.64 F1: 0.62
‚úÖ New best model saved with eval accuracy: 63.80%

Epoch [20/100]
Train Loss: 1.2897 Acc: 60.81% | Eval Loss: 1.3932 Acc: 61.10% Prec: 0.65 Recall: 0.61 F1: 0.60

Epoch [21/100]
Train Loss: 1.2327 Acc: 62.60% | Eval Loss: 1.4252 Acc: 60.80% Prec: 0.64 Recall: 0.61 F1: 0.60

Epoch [22/100]
Train Loss: 1.2030 Acc: 63.07% | Eval Loss: 1.2947 Acc: 64.20% Prec: 0.70 Recall: 0.64 F1: 0.63
‚úÖ New best model saved with eval accuracy: 64.20%

Epoch [23/100]
Train Loss: 1.1630 Acc: 64.21% | Eval Loss: 1.2672 Acc: 64.20% Prec: 0.70 Recall: 0.64 F1: 0.63

Epoch [24/100]
Train Loss: 1.1380 Acc: 65.40% | Eval Loss: 1.2129 Acc: 65.30% Prec: 0.67 Recall: 0.65 F1: 0.64
‚úÖ New best model saved with eval accuracy: 65.30%

Epoch [25/100]
Train Loss: 1.1103 Acc: 65.80% | Eval Loss: 1.2036 Acc: 66.50% Prec: 0.72 Recall: 0.67 F1: 0.66
‚úÖ New best model saved with eval accuracy: 66.50%

Epoch [26/100]
Train Loss: 1.1173 Acc: 65.41% | Eval Loss: 1.2138 Acc: 64.90% Prec: 0.69 Recall: 0.65 F1: 0.63

Epoch [27/100]
Train Loss: 1.1084 Acc: 65.80% | Eval Loss: 1.2220 Acc: 65.80% Prec: 0.70 Recall: 0.66 F1: 0.65

Epoch [28/100]
Train Loss: 1.0739 Acc: 66.96% | Eval Loss: 1.3159 Acc: 64.10% Prec: 0.71 Recall: 0.64 F1: 0.64

Epoch [29/100]
Train Loss: 1.0304 Acc: 68.06% | Eval Loss: 1.2720 Acc: 65.10% Prec: 0.71 Recall: 0.65 F1: 0.64

Epoch [30/100]
Train Loss: 0.9895 Acc: 69.04% | Eval Loss: 1.3697 Acc: 62.70% Prec: 0.67 Recall: 0.63 F1: 0.61

Epoch [31/100]
Train Loss: 0.9835 Acc: 69.09% | Eval Loss: 1.1460 Acc: 68.50% Prec: 0.70 Recall: 0.69 F1: 0.67
‚úÖ New best model saved with eval accuracy: 68.50%

Epoch [32/100]
Train Loss: 0.9503 Acc: 70.23% | Eval Loss: 1.2636 Acc: 66.50% Prec: 0.71 Recall: 0.67 F1: 0.65

Epoch [33/100]
Train Loss: 0.9201 Acc: 70.83% | Eval Loss: 1.2742 Acc: 65.90% Prec: 0.71 Recall: 0.66 F1: 0.65

Epoch [34/100]
Train Loss: 0.9293 Acc: 70.96% | Eval Loss: 1.2202 Acc: 67.50% Prec: 0.72 Recall: 0.68 F1: 0.67

Epoch [35/100]
Train Loss: 0.9053 Acc: 71.87% | Eval Loss: 1.2006 Acc: 68.30% Prec: 0.72 Recall: 0.68 F1: 0.67

Epoch [36/100]
Train Loss: 0.9198 Acc: 71.16% | Eval Loss: 1.2468 Acc: 66.60% Prec: 0.70 Recall: 0.67 F1: 0.65

Epoch [37/100]
Train Loss: 0.8760 Acc: 72.93% | Eval Loss: 1.2470 Acc: 67.80% Prec: 0.72 Recall: 0.68 F1: 0.67

Epoch [38/100]
Train Loss: 0.8554 Acc: 73.31% | Eval Loss: 1.2092 Acc: 67.70% Prec: 0.71 Recall: 0.68 F1: 0.67

Epoch [39/100]
Train Loss: 0.8403 Acc: 73.63% | Eval Loss: 1.3696 Acc: 65.70% Prec: 0.69 Recall: 0.66 F1: 0.65

Epoch [40/100]
Train Loss: 0.8316 Acc: 73.23% | Eval Loss: 1.2188 Acc: 67.90% Prec: 0.71 Recall: 0.68 F1: 0.67

Epoch [41/100]
Train Loss: 0.8046 Acc: 74.24% | Eval Loss: 1.3605 Acc: 65.50% Prec: 0.70 Recall: 0.66 F1: 0.65

Epoch [42/100]
Train Loss: 0.8134 Acc: 74.51% | Eval Loss: 1.2634 Acc: 68.10% Prec: 0.73 Recall: 0.68 F1: 0.67

Epoch [43/100]
Train Loss: 0.8118 Acc: 74.37% | Eval Loss: 1.2891 Acc: 68.10% Prec: 0.72 Recall: 0.68 F1: 0.67

Epoch [44/100]
Train Loss: 0.7809 Acc: 75.27% | Eval Loss: 1.2489 Acc: 69.20% Prec: 0.71 Recall: 0.69 F1: 0.68
‚úÖ New best model saved with eval accuracy: 69.20%

Epoch [45/100]
Train Loss: 0.7716 Acc: 76.16% | Eval Loss: 1.3467 Acc: 67.30% Prec: 0.71 Recall: 0.67 F1: 0.66

Epoch [46/100]
Train Loss: 0.7517 Acc: 76.47% | Eval Loss: 1.4099 Acc: 65.90% Prec: 0.69 Recall: 0.66 F1: 0.65

Epoch [47/100]
Train Loss: 0.7452 Acc: 76.71% | Eval Loss: 1.3184 Acc: 67.70% Prec: 0.71 Recall: 0.68 F1: 0.67

Epoch [48/100]
Train Loss: 0.7289 Acc: 77.04% | Eval Loss: 1.3094 Acc: 69.10% Prec: 0.74 Recall: 0.69 F1: 0.68

Epoch [49/100]
Train Loss: 0.7165 Acc: 77.44% | Eval Loss: 1.2094 Acc: 70.10% Prec: 0.73 Recall: 0.70 F1: 0.70
‚úÖ New best model saved with eval accuracy: 70.10%

Epoch [50/100]
Train Loss: 0.7210 Acc: 77.19% | Eval Loss: 1.2634 Acc: 68.40% Prec: 0.72 Recall: 0.68 F1: 0.68

Epoch [51/100]
Train Loss: 0.7024 Acc: 77.93% | Eval Loss: 1.2935 Acc: 69.20% Prec: 0.73 Recall: 0.69 F1: 0.69

Epoch [52/100]
Train Loss: 0.7374 Acc: 76.89% | Eval Loss: 1.3021 Acc: 66.30% Prec: 0.70 Recall: 0.66 F1: 0.65

Epoch [53/100]
Train Loss: 0.7047 Acc: 78.11% | Eval Loss: 1.3862 Acc: 70.00% Prec: 0.74 Recall: 0.70 F1: 0.70

Epoch [54/100]
Train Loss: 0.6993 Acc: 78.21% | Eval Loss: 1.3060 Acc: 69.80% Prec: 0.72 Recall: 0.70 F1: 0.69

Epoch [55/100]
Train Loss: 0.6723 Acc: 78.91% | Eval Loss: 1.2602 Acc: 70.80% Prec: 0.74 Recall: 0.71 F1: 0.71
‚úÖ New best model saved with eval accuracy: 70.80%

Epoch [56/100]
Train Loss: 0.6905 Acc: 78.51% | Eval Loss: 1.3409 Acc: 68.60% Prec: 0.73 Recall: 0.69 F1: 0.68

Epoch [57/100]
Train Loss: 0.6668 Acc: 78.69% | Eval Loss: 1.3169 Acc: 70.10% Prec: 0.72 Recall: 0.70 F1: 0.69

Epoch [58/100]
Train Loss: 0.6768 Acc: 78.79% | Eval Loss: 1.3809 Acc: 68.50% Prec: 0.73 Recall: 0.69 F1: 0.68

Epoch [59/100]
Train Loss: 0.6574 Acc: 78.96% | Eval Loss: 1.5290 Acc: 67.30% Prec: 0.73 Recall: 0.67 F1: 0.67

Epoch [60/100]
Train Loss: 0.6531 Acc: 79.34% | Eval Loss: 1.4652 Acc: 68.00% Prec: 0.71 Recall: 0.68 F1: 0.68

Epoch [61/100]
Train Loss: 0.6269 Acc: 80.13% | Eval Loss: 1.3796 Acc: 68.30% Prec: 0.71 Recall: 0.68 F1: 0.68

Epoch [62/100]
Train Loss: 0.6053 Acc: 80.36% | Eval Loss: 1.4632 Acc: 68.00% Prec: 0.72 Recall: 0.68 F1: 0.68

Epoch [63/100]
Train Loss: 0.6550 Acc: 79.61% | Eval Loss: 1.5024 Acc: 68.20% Prec: 0.72 Recall: 0.68 F1: 0.68

Epoch [64/100]
Train Loss: 0.6082 Acc: 80.86% | Eval Loss: 1.4652 Acc: 68.70% Prec: 0.71 Recall: 0.69 F1: 0.68

Epoch [65/100]
Train Loss: 0.6024 Acc: 80.93% | Eval Loss: 1.5001 Acc: 68.30% Prec: 0.71 Recall: 0.68 F1: 0.68

Epoch [66/100]
Train Loss: 0.5827 Acc: 81.34% | Eval Loss: 1.4241 Acc: 68.60% Prec: 0.72 Recall: 0.69 F1: 0.68

Epoch [67/100]
Train Loss: 0.5843 Acc: 81.50% | Eval Loss: 1.4477 Acc: 68.00% Prec: 0.71 Recall: 0.68 F1: 0.67

Epoch [68/100]
Train Loss: 0.5801 Acc: 81.96% | Eval Loss: 1.5979 Acc: 66.30% Prec: 0.71 Recall: 0.66 F1: 0.66

Epoch [69/100]
Train Loss: 0.5700 Acc: 82.13% | Eval Loss: 1.4789 Acc: 68.30% Prec: 0.71 Recall: 0.68 F1: 0.68

Epoch [70/100]
Train Loss: 0.5834 Acc: 81.50% | Eval Loss: 1.4464 Acc: 70.40% Prec: 0.74 Recall: 0.70 F1: 0.70

‚èπÔ∏è Early stopping activado en epoch 70

Evaluating on test set...
Final Test Results - Loss: 1.4699 | Acc: 67.95% | Prec: 0.71 | Recall: 0.68 | F1: 0.68

Training completed!
Best model saved as 'best_model_resnet18_flush.pth'
Training history saved as 'training_history.json'
üìä Gr√°fico guardado como 'training_history_resnet18.png'
