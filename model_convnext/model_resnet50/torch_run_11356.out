Using device: cuda
Dataset sizes - Train: 7000, Eval: 1000, Test: 2000
Fine-tuning completo - todas las capas se entrenar√°n
Par√°metros totales: 23,712,932
Par√°metros entrenables: 23,712,932
Par√°metros congelados: 0
Optimizaci√≥n con learning rates diferenciados
Starting training...

Epoch [1/100]
Train Loss: 4.1002 Acc: 7.60% | Eval Loss: 3.1819 Acc: 20.80% Prec: 0.20 Recall: 0.21 F1: 0.16
‚úÖ New best model saved with eval accuracy: 20.80%

Epoch [2/100]
Train Loss: 2.9971 Acc: 20.67% | Eval Loss: 2.5906 Acc: 28.40% Prec: 0.32 Recall: 0.28 F1: 0.24
‚úÖ New best model saved with eval accuracy: 28.40%

Epoch [3/100]
Train Loss: 2.5233 Acc: 30.23% | Eval Loss: 2.0841 Acc: 40.30% Prec: 0.41 Recall: 0.40 F1: 0.36
‚úÖ New best model saved with eval accuracy: 40.30%

Epoch [4/100]
Train Loss: 2.2127 Acc: 37.11% | Eval Loss: 2.0573 Acc: 41.20% Prec: 0.48 Recall: 0.41 F1: 0.39
‚úÖ New best model saved with eval accuracy: 41.20%

Epoch [5/100]
Train Loss: 2.0049 Acc: 41.77% | Eval Loss: 1.7063 Acc: 48.70% Prec: 0.54 Recall: 0.49 F1: 0.45
‚úÖ New best model saved with eval accuracy: 48.70%

Epoch [6/100]
Train Loss: 1.8377 Acc: 45.29% | Eval Loss: 1.6625 Acc: 52.00% Prec: 0.52 Recall: 0.52 F1: 0.49
‚úÖ New best model saved with eval accuracy: 52.00%

Epoch [7/100]
Train Loss: 1.7122 Acc: 48.79% | Eval Loss: 1.6297 Acc: 53.10% Prec: 0.56 Recall: 0.53 F1: 0.51
‚úÖ New best model saved with eval accuracy: 53.10%

Epoch [8/100]
Train Loss: 1.6465 Acc: 50.67% | Eval Loss: 1.4883 Acc: 56.00% Prec: 0.66 Recall: 0.56 F1: 0.54
‚úÖ New best model saved with eval accuracy: 56.00%

Epoch [9/100]
Train Loss: 1.5427 Acc: 53.09% | Eval Loss: 1.3857 Acc: 59.80% Prec: 0.63 Recall: 0.60 F1: 0.58
‚úÖ New best model saved with eval accuracy: 59.80%

Epoch [10/100]
Train Loss: 1.4564 Acc: 55.94% | Eval Loss: 1.4686 Acc: 57.80% Prec: 0.65 Recall: 0.58 F1: 0.56

Epoch [11/100]
Train Loss: 1.4097 Acc: 56.80% | Eval Loss: 1.5168 Acc: 55.60% Prec: 0.61 Recall: 0.56 F1: 0.53

Epoch [12/100]
Train Loss: 1.3578 Acc: 58.37% | Eval Loss: 1.2444 Acc: 63.60% Prec: 0.66 Recall: 0.64 F1: 0.61
‚úÖ New best model saved with eval accuracy: 63.60%

Epoch [13/100]
Train Loss: 1.3165 Acc: 59.41% | Eval Loss: 1.3218 Acc: 63.50% Prec: 0.68 Recall: 0.64 F1: 0.61

Epoch [14/100]
Train Loss: 1.2222 Acc: 61.80% | Eval Loss: 1.4502 Acc: 60.40% Prec: 0.64 Recall: 0.60 F1: 0.58

Epoch [15/100]
Train Loss: 1.1759 Acc: 63.43% | Eval Loss: 1.1814 Acc: 63.10% Prec: 0.66 Recall: 0.63 F1: 0.62

Epoch [16/100]
Train Loss: 1.1131 Acc: 64.90% | Eval Loss: 1.1543 Acc: 66.40% Prec: 0.72 Recall: 0.66 F1: 0.65
‚úÖ New best model saved with eval accuracy: 66.40%

Epoch [17/100]
Train Loss: 1.1128 Acc: 64.89% | Eval Loss: 1.1560 Acc: 67.90% Prec: 0.73 Recall: 0.68 F1: 0.67
‚úÖ New best model saved with eval accuracy: 67.90%

Epoch [18/100]
Train Loss: 1.0751 Acc: 66.21% | Eval Loss: 1.0993 Acc: 68.50% Prec: 0.72 Recall: 0.69 F1: 0.67
‚úÖ New best model saved with eval accuracy: 68.50%

Epoch [19/100]
Train Loss: 1.0295 Acc: 67.16% | Eval Loss: 1.0419 Acc: 69.90% Prec: 0.74 Recall: 0.70 F1: 0.70
‚úÖ New best model saved with eval accuracy: 69.90%

Epoch [20/100]
Train Loss: 1.0060 Acc: 67.67% | Eval Loss: 1.0442 Acc: 69.60% Prec: 0.72 Recall: 0.70 F1: 0.68

Epoch [21/100]
Train Loss: 0.9719 Acc: 68.81% | Eval Loss: 1.1050 Acc: 69.50% Prec: 0.73 Recall: 0.70 F1: 0.68

Epoch [22/100]
Train Loss: 0.9293 Acc: 69.71% | Eval Loss: 1.2781 Acc: 65.90% Prec: 0.68 Recall: 0.66 F1: 0.64

Epoch [23/100]
Train Loss: 0.9023 Acc: 71.51% | Eval Loss: 1.1860 Acc: 66.90% Prec: 0.71 Recall: 0.67 F1: 0.66

Epoch [24/100]
Train Loss: 0.8759 Acc: 72.03% | Eval Loss: 1.1381 Acc: 69.40% Prec: 0.73 Recall: 0.69 F1: 0.69

Epoch [25/100]
Train Loss: 0.8662 Acc: 72.00% | Eval Loss: 1.3968 Acc: 65.00% Prec: 0.69 Recall: 0.65 F1: 0.63

Epoch [26/100]
Train Loss: 0.8660 Acc: 72.10% | Eval Loss: 1.1971 Acc: 68.20% Prec: 0.73 Recall: 0.68 F1: 0.67

Epoch [27/100]
Train Loss: 0.8290 Acc: 73.66% | Eval Loss: 1.1621 Acc: 68.00% Prec: 0.73 Recall: 0.68 F1: 0.67

Epoch [28/100]
Train Loss: 0.8272 Acc: 73.40% | Eval Loss: 1.1410 Acc: 70.20% Prec: 0.75 Recall: 0.70 F1: 0.69
‚úÖ New best model saved with eval accuracy: 70.20%

Epoch [29/100]
Train Loss: 0.7892 Acc: 74.33% | Eval Loss: 1.2738 Acc: 67.90% Prec: 0.73 Recall: 0.68 F1: 0.67

Epoch [30/100]
Train Loss: 0.7765 Acc: 74.80% | Eval Loss: 1.0794 Acc: 73.00% Prec: 0.77 Recall: 0.73 F1: 0.72
‚úÖ New best model saved with eval accuracy: 73.00%

Epoch [31/100]
Train Loss: 0.7590 Acc: 74.76% | Eval Loss: 1.2339 Acc: 71.20% Prec: 0.76 Recall: 0.71 F1: 0.71

Epoch [32/100]
Train Loss: 0.7788 Acc: 74.96% | Eval Loss: 1.1262 Acc: 71.40% Prec: 0.75 Recall: 0.71 F1: 0.71

Epoch [33/100]
Train Loss: 0.7260 Acc: 76.51% | Eval Loss: 1.1270 Acc: 71.50% Prec: 0.77 Recall: 0.72 F1: 0.71

Epoch [34/100]
Train Loss: 0.7117 Acc: 76.73% | Eval Loss: 1.1357 Acc: 72.70% Prec: 0.77 Recall: 0.73 F1: 0.72

Epoch [35/100]
Train Loss: 0.6922 Acc: 77.64% | Eval Loss: 1.1782 Acc: 71.10% Prec: 0.74 Recall: 0.71 F1: 0.70

Epoch [36/100]
Train Loss: 0.6728 Acc: 77.73% | Eval Loss: 1.1205 Acc: 72.90% Prec: 0.76 Recall: 0.73 F1: 0.72

Epoch [37/100]
Train Loss: 0.6741 Acc: 78.46% | Eval Loss: 1.2020 Acc: 70.40% Prec: 0.74 Recall: 0.70 F1: 0.69

Epoch [38/100]
Train Loss: 0.6529 Acc: 78.26% | Eval Loss: 1.3452 Acc: 71.00% Prec: 0.73 Recall: 0.71 F1: 0.70

Epoch [39/100]
Train Loss: 0.6549 Acc: 78.26% | Eval Loss: 1.0646 Acc: 74.30% Prec: 0.77 Recall: 0.74 F1: 0.74
‚úÖ New best model saved with eval accuracy: 74.30%

Epoch [40/100]
Train Loss: 0.6232 Acc: 79.51% | Eval Loss: 1.3144 Acc: 70.80% Prec: 0.75 Recall: 0.71 F1: 0.70

Epoch [41/100]
Train Loss: 0.6086 Acc: 79.96% | Eval Loss: 1.1561 Acc: 73.00% Prec: 0.76 Recall: 0.73 F1: 0.72

Epoch [42/100]
Train Loss: 0.6164 Acc: 79.76% | Eval Loss: 1.4150 Acc: 69.30% Prec: 0.76 Recall: 0.69 F1: 0.68

Epoch [43/100]
Train Loss: 0.6241 Acc: 79.74% | Eval Loss: 1.2647 Acc: 71.30% Prec: 0.76 Recall: 0.71 F1: 0.71

Epoch [44/100]
Train Loss: 0.5944 Acc: 80.49% | Eval Loss: 1.2939 Acc: 72.80% Prec: 0.76 Recall: 0.73 F1: 0.72

Epoch [45/100]
Train Loss: 0.5908 Acc: 80.49% | Eval Loss: 1.2976 Acc: 71.90% Prec: 0.76 Recall: 0.72 F1: 0.71

Epoch [46/100]
Train Loss: 0.5706 Acc: 81.26% | Eval Loss: 1.4825 Acc: 71.10% Prec: 0.76 Recall: 0.71 F1: 0.71

Epoch [47/100]
Train Loss: 0.5660 Acc: 81.51% | Eval Loss: 1.3325 Acc: 71.20% Prec: 0.75 Recall: 0.71 F1: 0.70

Epoch [48/100]
Train Loss: 0.5786 Acc: 81.24% | Eval Loss: 1.3714 Acc: 70.40% Prec: 0.76 Recall: 0.70 F1: 0.70

Epoch [49/100]
Train Loss: 0.5788 Acc: 81.50% | Eval Loss: 1.3022 Acc: 74.00% Prec: 0.76 Recall: 0.74 F1: 0.73

Epoch [50/100]
Train Loss: 0.5280 Acc: 82.81% | Eval Loss: 1.2094 Acc: 73.60% Prec: 0.77 Recall: 0.74 F1: 0.73

Epoch [51/100]
Train Loss: 0.5502 Acc: 81.73% | Eval Loss: 1.2323 Acc: 73.40% Prec: 0.77 Recall: 0.73 F1: 0.73

Epoch [52/100]
Train Loss: 0.5281 Acc: 82.81% | Eval Loss: 1.1655 Acc: 75.10% Prec: 0.78 Recall: 0.75 F1: 0.75
‚úÖ New best model saved with eval accuracy: 75.10%

Epoch [53/100]
Train Loss: 0.5206 Acc: 82.97% | Eval Loss: 1.2446 Acc: 74.60% Prec: 0.79 Recall: 0.75 F1: 0.74

Epoch [54/100]
Train Loss: 0.5081 Acc: 83.50% | Eval Loss: 1.4689 Acc: 71.50% Prec: 0.76 Recall: 0.72 F1: 0.71

Epoch [55/100]
Train Loss: 0.5206 Acc: 83.37% | Eval Loss: 1.2779 Acc: 74.10% Prec: 0.79 Recall: 0.74 F1: 0.73

Epoch [56/100]
Train Loss: 0.5275 Acc: 83.03% | Eval Loss: 1.1646 Acc: 76.10% Prec: 0.80 Recall: 0.76 F1: 0.76
‚úÖ New best model saved with eval accuracy: 76.10%

Epoch [57/100]
Train Loss: 0.4723 Acc: 84.51% | Eval Loss: 1.1018 Acc: 76.60% Prec: 0.80 Recall: 0.77 F1: 0.76
‚úÖ New best model saved with eval accuracy: 76.60%

Epoch [58/100]
Train Loss: 0.4891 Acc: 83.94% | Eval Loss: 1.3776 Acc: 71.00% Prec: 0.76 Recall: 0.71 F1: 0.70

Epoch [59/100]
Train Loss: 0.5239 Acc: 83.31% | Eval Loss: 1.2546 Acc: 73.80% Prec: 0.78 Recall: 0.74 F1: 0.74

Epoch [60/100]
Train Loss: 0.4801 Acc: 84.93% | Eval Loss: 1.3910 Acc: 73.60% Prec: 0.79 Recall: 0.74 F1: 0.72

Epoch [61/100]
Train Loss: 0.4578 Acc: 84.94% | Eval Loss: 1.2590 Acc: 74.40% Prec: 0.78 Recall: 0.74 F1: 0.74

Epoch [62/100]
Train Loss: 0.4597 Acc: 84.64% | Eval Loss: 1.2784 Acc: 73.80% Prec: 0.77 Recall: 0.74 F1: 0.73

Epoch [63/100]
Train Loss: 0.4504 Acc: 85.53% | Eval Loss: 1.1943 Acc: 75.60% Prec: 0.79 Recall: 0.76 F1: 0.75

Epoch [64/100]
Train Loss: 0.4539 Acc: 85.24% | Eval Loss: 1.3017 Acc: 72.60% Prec: 0.77 Recall: 0.73 F1: 0.72

Epoch [65/100]
Train Loss: 0.4286 Acc: 86.26% | Eval Loss: 1.3736 Acc: 72.20% Prec: 0.76 Recall: 0.72 F1: 0.72

Epoch [66/100]
Train Loss: 0.4528 Acc: 85.24% | Eval Loss: 1.3182 Acc: 74.70% Prec: 0.78 Recall: 0.75 F1: 0.74

Epoch [67/100]
Train Loss: 0.4779 Acc: 83.93% | Eval Loss: 1.3315 Acc: 75.00% Prec: 0.78 Recall: 0.75 F1: 0.74

Epoch [68/100]
Train Loss: 0.4604 Acc: 84.80% | Eval Loss: 1.3963 Acc: 72.90% Prec: 0.76 Recall: 0.73 F1: 0.72

Epoch [69/100]
Train Loss: 0.4190 Acc: 86.36% | Eval Loss: 1.2388 Acc: 74.60% Prec: 0.77 Recall: 0.75 F1: 0.74

Epoch [70/100]
Train Loss: 0.4317 Acc: 85.99% | Eval Loss: 1.3387 Acc: 76.50% Prec: 0.80 Recall: 0.77 F1: 0.76

Epoch [71/100]
Train Loss: 0.4369 Acc: 86.01% | Eval Loss: 1.2031 Acc: 75.40% Prec: 0.79 Recall: 0.75 F1: 0.75

Epoch [72/100]
Train Loss: 0.3908 Acc: 87.10% | Eval Loss: 1.2674 Acc: 75.60% Prec: 0.80 Recall: 0.76 F1: 0.75

‚èπÔ∏è Early stopping activado en epoch 72

Evaluating on test set...
Final Test Results - Loss: 1.2922 | Acc: 74.20% | Prec: 0.77 | Recall: 0.74 | F1: 0.74

Training completed!
Best model saved as 'best_model_resnet50_flush.pth'
Training history saved as 'training_history.json'
üìä Gr√°fico guardado como 'training_history_resnet50.png'
